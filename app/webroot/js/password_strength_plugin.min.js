/**
 * password_strength_plugin.js
 * Copyright (c) 20010 myPocket technologies (www.mypocket-technologies.com)
 

 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 * @author Darren Mason (djmason9@gmail.com)
 * @date 3/13/2009
 * @projectDescription Password Strength Meter is a jQuery plug-in provide you smart algorithm to detect a password strength. Based on Firas Kassem orginal plugin - http://phiras.wordpress.com/2007/04/08/password-strength-meter-a-jquery-plugin/
 * @version 1.0.1
 * 
 * @requires jquery.js (tested with 1.3.2)
 * @param shortPass:	"shortPass",	//optional
 * @param badPass:		"badPass",		//optional
 * @param goodPass:		"goodPass",		//optional
 * @param strongPass:	"strongPass",	//optional
 * @param baseStyle:	"testresult",	//optional
 * @param userid:		"",				//required override
 * @param messageloc:	1				//before == 0 or after == 1
 * 
*/

(function(a){a.fn.shortPass="Too short";a.fn.badPass="Weak";a.fn.goodPass="Good";a.fn.strongPass="Strong";a.fn.samePassword="Username and Password identical.";a.fn.resultStyle="";a.fn.passStrength=function(b){var c={shortPass:"shortPass",badPass:"badPass",goodPass:"goodPass",strongPass:"strongPass",baseStyle:"testresult",userid:"",messageloc:1};var d=a.extend(c,b);return this.each(function(){var b=a(this);a(b).unbind().keyup(function(){var b=a.fn.teststrength(a(this).val(),a(d.userid).val(),d);if(d.messageloc===1){a(this).next("."+d.baseStyle).remove();a(this).after('<span class="'+d.baseStyle+'"><span></span></span>');a(this).next("."+d.baseStyle).addClass(a(this).resultStyle).find("span").text(b)}else{a(this).prev("."+d.baseStyle).remove();a(this).before('<span class="'+d.baseStyle+'"><span></span></span>');a(this).prev("."+d.baseStyle).addClass(a(this).resultStyle).find("span").text(b)}});a.fn.teststrength=function(b,c,d){var e=0;if(b.length<4){this.resultStyle=d.shortPass;return a(this).shortPass}if(b.toLowerCase()==c.toLowerCase()){this.resultStyle=d.badPass;return a(this).samePassword}e+=b.length*4;e+=(a.fn.checkRepetition(1,b).length-b.length)*1;e+=(a.fn.checkRepetition(2,b).length-b.length)*1;e+=(a.fn.checkRepetition(3,b).length-b.length)*1;e+=(a.fn.checkRepetition(4,b).length-b.length)*1;if(b.match(/(.*[0-9].*[0-9].*[0-9])/)){e+=5}if(b.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){e+=5}if(b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){e+=10}if(b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)){e+=15}if(b.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&b.match(/([0-9])/)){e+=15}if(b.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&b.match(/([a-zA-Z])/)){e+=15}if(b.match(/^\w+$/)||b.match(/^\d+$/)){e-=10}if(e<0){e=0}if(e>100){e=100}if(e<34){this.resultStyle=d.badPass;return a(this).badPass}if(e<68){this.resultStyle=d.goodPass;return a(this).goodPass}this.resultStyle=d.strongPass;return a(this).strongPass}})}})(jQuery);$.fn.checkRepetition=function(a,b){var c="";for(var d=0;d<b.length;d++){var e=true;for(var f=0;f<a&&f+d+a<b.length;f++){e=e&&b.charAt(f+d)==b.charAt(f+d+a)}if(f<a){e=false}if(e){d+=a-1;e=false}else{c+=b.charAt(d)}}return c}